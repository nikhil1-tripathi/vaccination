<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>VACCINATION SYSTEM</h1>
    <input type="text" id="name" />
    <h2 id="h2"></h2>
    <h3 id="h3"></h3>
    <button onclick="registration()">Register</button>
  </body>
</html>
<script>
  let vaccine = 3;
  let line = ["ram", "shyam", "seeta", "ravan"];
  function registration() {
    let name = document.getElementById("name").value;
    // console.log(name)
    let message = `${name} your registration is successfull. Please wait for your message.`;
    alert(message);
    line.push(name);

    var myPromise = new Promise(function (resolve, reject) {
      setInterval(() => {
        if (line[0] === name) {
          resolve(`${name} Its your turn for vaccination now`);
        }
      }, 1000);
    });
    myPromise.then(function (res) {
      alert(res);
    });
  }
  function startvaccination() {
    line.shift();
    vaccine--;
    var remaining_vaccine = document.getElementById("h3");
    remaining_vaccine.textContent = "REMAINING_VACCINE = " + vaccine;
    document.querySelector("body").append(remaining_vaccine);
    console.log(line);

    if (vaccine === 0) {
      alert("vaccine is finished please come back tomorrow");
      clearInterval(id);
    }

    if (line.length == 0) {
      clearInterval(id);
    }

    var queue = document.getElementById("h2");
    queue.textContent = "QUEUE = " + line;
    document.querySelector("body").append(queue);
  }

  let id = setInterval(startvaccination, 2000);
  // startvaccination();
</script>
